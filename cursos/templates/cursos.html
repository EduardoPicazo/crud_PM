{% extends 'base.html' %}

{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1>Curso</h1>
    <a href="{% url 'agregar_curso' %}" class="btn btn-primary">
      <i class="fa-solid fa-plus"></i> Agregar Curso
    </a>
  </div>

  <div class="table-responsive">
    <table class="table table-striped table-hover">
      <thead class="table-dark">
      <tr>
            <th>Nombre</th>
            <th>Descripción</th>
            <th>Cupo</th>
            <th>Docente</th>
            <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for curso in cursos %}
        <tr>
            <td>{{ curso.nombre }}</td>
            <td>{{ curso.descripcion}}</td>
            <td>{{ curso.cupo_disponible }}</td>
            <td>{{ curso.docente }}</td>
            <td>
              <button class="btn btn-info btn-sm ver-curso"
                data-nombre="{{ curso.nombre }}"
                data-descripcion="{{ curso.descripcion }}"
                data-fecha-inicio="{{ curso.fecha_inicio }}"
                data-fecha-cierre="{{ curso.fecha_cierre }}"
                data-horario="{{ curso.horario }}"
                data-cupo="{{ curso.cupo_disponible }}"
                data-docente="{{ curso.docente }}">
                Ver curso
              </button> 
                <!-- Botón Editar -->
                <button class="btn btn-warning btn-sm" data-bs-toggle="modal" data-bs-target="#editarModal{{ curso.id }}">
                <i class="bi bi-pencil"></i> Editar</button>


              <a href="{% url 'eliminar_curso' curso.id %}" 
              class="btn btn-danger btn-sm"
              onclick="return confirm('¿Estás seguro de eliminar este curso?');">
                <i class="bi bi-trash me-2"></i> Eliminar
              </a>
            </td>
        </tr>
        <div class="modal fade" id="editarModal{{ curso.id }}" tabindex="-1" aria-labelledby="editarModalLabel{{ curso.id }}" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form method="post" action="{% url 'editar_curso' curso.id %}">
        {% csrf_token %}
        <div class="modal-header">
          <h5 class="modal-title" id="editarModalLabel{{ curso.id }}">Editar Curso</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label class="form-label">Nombre</label>
            <input type="text" name="nombre" class="form-control" value="{{ curso.nombre }}" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Descripción</label>
            <textarea name="descripcion" class="form-control" required>{{ curso.descripcion }}</textarea>
          </div>
          <div class="mb-3">
            <label class="form-label">Fecha Inicio</label>
            <input type="date" name="fecha_inicio" class="form-control" value="{{ curso.fecha_inicio|date:'Y-m-d' }}" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Fecha Cierre</label>
            <input type="date" name="fecha_cierre" class="form-control" value="{{ curso.fecha_cierre|date:'Y-m-d' }}" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Horario</label>
            <input type="text" name="horario" class="form-control" value="{{ curso.horario }}" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Cupo Disponible</label>
            <input type="number" name="cupo_disponible" class="form-control" value="{{ curso.cupo_disponible }}" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Docente</label>
            <input type="text" name="docente" class="form-control" value="{{ curso.docente }}" required>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="submit" class="btn btn-primary">Guardar cambios</button>
        </div>
      </form>
    </div>
  </div>
</div>
        {% empty %}
        <tr>
            <td colspan="8">No hay cursos registrados.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  
  

  <!-- Modal -->
  <div class="modal fade" id="cursoModal" tabindex="-1" aria-labelledby="cursoModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="cursoModalLabel">Detalles del Curso</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <p><strong>Nombre:</strong> <span id="modalNombre"></span></p>
          <p><strong>Descripción:</strong> <span id="modalDescripcion"></span></p>
          <p><strong>Fecha Inicio:</strong> <span id="modalFechaInicio"></span></p>
          <p><strong>Fecha Cierre:</strong> <span id="modalFechaCierre"></span></p>
          <p><strong>Horario:</strong> <span id="modalHorario"></span></p>
          <p><strong>Cupo Disponible:</strong> <span id="modalCupo"></span></p>
          <p><strong>Docente:</strong> <span id="modalDocente"></span></p>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const botones = document.querySelectorAll(".ver-curso");
      const modalNombre = document.getElementById("modalNombre");
      const modalDescripcion = document.getElementById("modalDescripcion");
      const modalFechaInicio = document.getElementById("modalFechaInicio");
      const modalFechaCierre = document.getElementById("modalFechaCierre");
      const modalHorario = document.getElementById("modalHorario");
      const modalCupo = document.getElementById("modalCupo");
      const modalDocente = document.getElementById("modalDocente");

      botones.forEach(boton => {
        boton.addEventListener("click", () => {
          modalNombre.textContent = boton.dataset.nombre;
          modalDescripcion.textContent = boton.dataset.descripcion;
          modalFechaInicio.textContent = boton.dataset["fechaInicio"];
          modalFechaCierre.textContent = boton.dataset["fechaCierre"];
          modalHorario.textContent = boton.dataset.horario;
          modalCupo.textContent = boton.dataset.cupo;
          modalDocente.textContent = boton.dataset.docente;

          const modal = new bootstrap.Modal(document.getElementById("cursoModal"));
          modal.show();
        });
      });
    });
  </script>
{% endblock %}